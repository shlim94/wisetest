(function(){function n(n){var t={opts:n},r;return t.FRAMERATE=30,t.MAX_VIRTUAL_PIXELS=3e4,t.log=function(){},t.opts.log==!0&&typeof console!="undefined"&&(t.log=function(n){console.log(n)}),t.init=function(n){var i=0;t.UniqueId=function(){return i++,"canvg"+i};t.Definitions={};t.Styles={};t.Animations=[];t.Images=[];t.ctx=n;t.ViewPort=new function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(n,t){this.viewPorts.push({width:n,height:t})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(n){return n!=null&&typeof n=="number"?n:n=="x"?this.width():n=="y"?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},t.init(),t.ImagesLoaded=function(){for(var n=0;n<t.Images.length;n++)if(!t.Images[n].loaded)return!1;return!0},t.trim=function(n){return n.replace(/^\s+|\s+$/g,"")},t.compressSpaces=function(n){return n.replace(/[\s\r\t\n]+/gm," ")},t.ajax=function(n){var t;return(t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t)?(t.open("GET",n,!1),t.send(null),t.responseText):null},t.parseXml=function(n){var i,r,t;return typeof Windows!="undefined"&&typeof Windows.Data!="undefined"&&typeof Windows.Data.Xml!="undefined"?(t=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings,i.prohibitDtd=!1,t.loadXml(n,i),t):window.DOMParser?(r=new DOMParser,r.parseFromString(n,"text/xml")):(n=n.replace(/<!DOCTYPE svg[^>]*>/,""),t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n),t)},t.Property=function(n,t){this.name=n;this.value=t},t.Property.prototype.getValue=function(){return this.value},t.Property.prototype.hasValue=function(){return this.value!=null&&this.value!==""},t.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var n=parseFloat(this.value);return(this.value+"").match(/%$/)&&(n=n/100),n},t.Property.prototype.valueOrDefault=function(n){return this.hasValue()?this.value:n},t.Property.prototype.numValueOrDefault=function(n){return this.hasValue()?this.numValue():n},t.Property.prototype.addOpacity=function(n){var r=this.value,i;return n.value!=null&&n.value!=""&&typeof this.value=="string"&&(i=new RGBColor(this.value),i.ok&&(r="rgba("+i.r+", "+i.g+", "+i.b+", "+n.numValue()+")")),new t.Property(this.name,r)},t.Property.prototype.getDefinition=function(){var n=this.value.match(/#([^\)'"]+)/);return n&&(n=n[1]),n||(n=this.value),t.Definitions[n]},t.Property.prototype.isUrlDefinition=function(){return this.value.indexOf("url(")==0},t.Property.prototype.getFillStyleDefinition=function(n,i){var r=this.getDefinition(),u;return r!=null&&r.createGradient?r.createGradient(t.ctx,n,i):r!=null&&r.createPattern?(r.getHrefAttribute().hasValue()&&(u=r.attribute("patternTransform"),r=r.getHrefAttribute().getDefinition(),u.hasValue()&&(r.attribute("patternTransform",!0).value=u.value)),r.createPattern(t.ctx,n)):null},t.Property.prototype.getDPI=function(){return 96},t.Property.prototype.getEM=function(n){var i=12,r=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);return r.hasValue()&&(i=r.toPixels(n)),i},t.Property.prototype.getUnits=function(){var n=this.value+"";return n.replace(/[0-9\.\-]/g,"")},t.Property.prototype.toPixels=function(n,i){var r,u;return this.hasValue()?(r=this.value+"",r.match(/em$/))?this.numValue()*this.getEM(n):r.match(/ex$/)?this.numValue()*this.getEM(n)/2:r.match(/px$/)?this.numValue():r.match(/pt$/)?this.numValue()*this.getDPI(n)*(1/72):r.match(/pc$/)?this.numValue()*15:r.match(/cm$/)?this.numValue()*this.getDPI(n)/2.54:r.match(/mm$/)?this.numValue()*this.getDPI(n)/25.4:r.match(/in$/)?this.numValue()*this.getDPI(n):r.match(/%$/)?this.numValue()*t.ViewPort.ComputeSize(n):(u=this.numValue(),i&&u<1)?u*t.ViewPort.ComputeSize(n):u:0},t.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var n=this.value+"";return n.match(/s$/)?this.numValue()*1e3:(n.match(/ms$/),this.numValue())},t.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var n=this.value+"";return n.match(/deg$/)?this.numValue()*(Math.PI/180):n.match(/grad$/)?this.numValue()*(Math.PI/200):n.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},r={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"},t.Property.prototype.toTextBaseline=function(){return this.hasValue()?r[this.value]:null},t.Font=new function(){this.Styles="normal|italic|oblique|inherit";this.Variants="normal|small-caps|inherit";this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";this.CreateFont=function(n,i,r,u,f,e){var o=e!=null?this.Parse(e):this.CreateFont("","","","","",t.ctx.font);return{fontFamily:f||o.fontFamily,fontSize:u||o.fontSize,fontStyle:n||o.fontStyle,fontWeight:r||o.fontWeight,fontVariant:i||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var n=this;this.Parse=function(i){for(var e={},u=t.trim(t.compressSpaces(i||"")).split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},o="",r=0;r<u.length;r++)f.fontStyle||n.Styles.indexOf(u[r])==-1?f.fontVariant||n.Variants.indexOf(u[r])==-1?f.fontWeight||n.Weights.indexOf(u[r])==-1?f.fontSize?u[r]!="inherit"&&(o+=u[r]):(u[r]!="inherit"&&(e.fontSize=u[r].split("/")[0]),f.fontStyle=f.fontVariant=f.fontWeight=f.fontSize=!0):(u[r]!="inherit"&&(e.fontWeight=u[r]),f.fontStyle=f.fontVariant=f.fontWeight=!0):(u[r]!="inherit"&&(e.fontVariant=u[r]),f.fontStyle=f.fontVariant=!0):(u[r]!="inherit"&&(e.fontStyle=u[r]),f.fontStyle=!0);return o!=""&&(e.fontFamily=o),e}},t.ToNumberArray=function(n){for(var i=t.trim(t.compressSpaces((n||"").replace(/,/g," "))).split(" "),r=0;r<i.length;r++)i[r]=parseFloat(i[r]);return i},t.Point=function(n,t){this.x=n;this.y=t},t.Point.prototype.angleTo=function(n){return Math.atan2(n.y-this.y,n.x-this.x)},t.Point.prototype.applyTransform=function(n){var t=this.x*n[0]+this.y*n[2]+n[4],i=this.x*n[1]+this.y*n[3]+n[5];this.x=t;this.y=i},t.CreatePoint=function(n){var i=t.ToNumberArray(n);return new t.Point(i[0],i[1])},t.CreatePath=function(n){for(var r=t.ToNumberArray(n),u=[],i=0;i<r.length;i+=2)u.push(new t.Point(r[i],r[i+1]));return u},t.BoundingBox=function(n,t,r,u){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(n,t){n!=null&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=n,this.x2=n),n<this.x1&&(this.x1=n),n>this.x2&&(this.x2=n));t!=null&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))};this.addX=function(n){this.addPoint(n,null)};this.addY=function(n){this.addPoint(null,n)};this.addBoundingBox=function(n){this.addPoint(n.x1,n.y1);this.addPoint(n.x2,n.y2)};this.addQuadraticCurve=function(n,t,i,r,u,f){var e=n+2/3*(i-n),o=t+2/3*(r-t),s=e+1/3*(u-n),h=o+1/3*(f-t);this.addBezierCurve(n,t,e,s,o,h,u,f)};this.addBezierCurve=function(n,t,r,u,f,e,o,s){var h=[n,t],p=[r,u],d=[f,e],w=[o,s],a,k,v,y;for(this.addPoint(h[0],h[1]),this.addPoint(w[0],w[1]),i=0;i<=1;i++){var c=function(n){return Math.pow(1-n,3)*h[i]+3*Math.pow(1-n,2)*n*p[i]+3*(1-n)*Math.pow(n,2)*d[i]+Math.pow(n,3)*w[i]},l=6*h[i]-12*p[i]+6*d[i],b=-3*h[i]+9*p[i]-9*d[i]+3*w[i],g=3*p[i]-3*h[i];if(b==0){if(l==0)continue;a=-g/l;0<a&&a<1&&(i==0&&this.addX(c(a)),i==1&&this.addY(c(a)));continue}(k=Math.pow(l,2)-4*g*b,k<0)||(v=(-l+Math.sqrt(k))/(2*b),0<v&&v<1&&(i==0&&this.addX(c(v)),i==1&&this.addY(c(v))),y=(-l-Math.sqrt(k))/(2*b),0<y&&y<1&&(i==0&&this.addX(c(y)),i==1&&this.addY(c(y))))}};this.isPointInBox=function(n,t){return this.x1<=n&&n<=this.x2&&this.y1<=t&&t<=this.y2};this.addPoint(n,t);this.addPoint(r,u)},t.Transform=function(n){var u=this,r,i;for(this.Type={},this.Type.translate=function(n){this.p=t.CreatePoint(n);this.apply=function(n){n.translate(this.p.x||0,this.p.y||0)};this.unapply=function(n){n.translate(-1*this.p.x||0,-1*this.p.y||0)};this.applyToPoint=function(n){n.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(n){var i=t.ToNumberArray(n);this.angle=new t.Property("angle",i[0]);this.cx=i[1]||0;this.cy=i[2]||0;this.apply=function(n){n.translate(this.cx,this.cy);n.rotate(this.angle.toRadians());n.translate(-this.cx,-this.cy)};this.unapply=function(n){n.translate(this.cx,this.cy);n.rotate(-1*this.angle.toRadians());n.translate(-this.cx,-this.cy)};this.applyToPoint=function(n){var t=this.angle.toRadians();n.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);n.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]);n.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(n){this.p=t.CreatePoint(n);this.apply=function(n){n.scale(this.p.x||1,this.p.y||this.p.x||1)};this.unapply=function(n){n.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)};this.applyToPoint=function(n){n.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(n){this.m=t.ToNumberArray(n);this.apply=function(n){n.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.unapply=function(n){var h=this.m[0],c=this.m[2],u=this.m[4],f=this.m[1],e=this.m[3],t=this.m[5],o=0,s=0,i=1,r=1/(h*(e*i-t*s)-c*(f*i-t*o)+u*(f*s-e*o));n.transform(r*(e*i-t*s),r*(t*o-f*i),r*(u*s-c*i),r*(h*i-u*o),r*(c*t-u*e),r*(u*f-h*t))};this.applyToPoint=function(n){n.applyTransform(this.m)}},this.Type.SkewBase=function(n){this.base=u.Type.matrix;this.base(n);this.angle=new t.Property("angle",n)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(n){this.base=u.Type.SkewBase;this.base(n);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(n){this.base=u.Type.SkewBase;this.base(n);this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(n){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(n)},this.unapply=function(n){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(n)},this.applyToPoint=function(n){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(n)},r=t.trim(t.compressSpaces(n)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<r.length;i++){var f=t.trim(r[i].split("(")[0]),o=r[i].split("(")[1].replace(")",""),e=new this.Type[f](o);e.type=f;this.transforms.push(e)}},t.AspectRatio=function(n,i,r,u,f,e,o,s,h,c){i=t.compressSpaces(i);i=i.replace(/^defer\s/,"");var w=i.split(" ")[0]||"xMidYMid",l=i.split(" ")[1]||"meet",y=r/u,p=f/e,a=Math.min(y,p),v=Math.max(y,p);l=="meet"&&(u*=a,e*=a);l=="slice"&&(u*=v,e*=v);h=new t.Property("refX",h);c=new t.Property("refY",c);h.hasValue()&&c.hasValue()?n.translate(-a*h.toPixels("x"),-a*c.toPixels("y")):(w.match(/^xMid/)&&(l=="meet"&&a==p||l=="slice"&&v==p)&&n.translate(r/2-u/2,0),w.match(/YMid$/)&&(l=="meet"&&a==y||l=="slice"&&v==y)&&n.translate(0,f/2-e/2),w.match(/^xMax/)&&(l=="meet"&&a==p||l=="slice"&&v==p)&&n.translate(r-u,0),w.match(/YMax$/)&&(l=="meet"&&a==y||l=="slice"&&v==y)&&n.translate(0,f-e));w=="none"?n.scale(y,p):l=="meet"?n.scale(a,a):l=="slice"&&n.scale(v,v);n.translate(o==null?0:-o,s==null?0:-s)},t.Element={},t.EmptyProperty=new t.Property("EMPTY",""),t.Element.ElementBase=function(n){var o,s,e,r,i,u,f,c;if(this.attributes={},this.styles={},this.children=[],this.attribute=function(n,i){var r=this.attributes[n];return r!=null?r:(i==!0&&(r=new t.Property(n,""),this.attributes[n]=r),r||t.EmptyProperty)},this.getHrefAttribute=function(){for(var n in this.attributes)if(n.match(/:href$/))return this.attributes[n];return t.EmptyProperty},this.style=function(n,i,r){var u=this.styles[n],f,o,e;return u!=null?u:(f=this.attribute(n),f!=null&&f.hasValue())?(this.styles[n]=f,f):r!=!0&&(o=this.parent,o!=null&&(e=o.style(n),e!=null&&e.hasValue()))?e:(i==!0&&(u=new t.Property(n,""),this.styles[n]=u),u||t.EmptyProperty)},this.render=function(n){var t,i;this.style("display").value!="none"&&this.style("visibility").value!="hidden"&&(n.save(),this.attribute("mask").hasValue()?(t=this.attribute("mask").getDefinition(),t!=null&&t.apply(n,this)):this.style("filter").hasValue()?(i=this.style("filter").getDefinition(),i!=null&&i.apply(n,this)):(this.setContext(n),this.renderChildren(n),this.clearContext(n)),n.restore())},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(n){for(var t=0;t<this.children.length;t++)this.children[t].render(n)},this.addChild=function(n,i){var r=n;i&&(r=t.CreateElement(n));r.parent=this;r.type!="title"&&this.children.push(r)},n!=null&&n.nodeType==1){for(u=0;u<n.attributes.length;u++)o=n.attributes[u],this.attributes[o.nodeName]=new t.Property(o.nodeName,o.nodeValue);if(i=t.Styles[n.nodeName],i!=null)for(r in i)this.styles[r]=i[r];if(this.attribute("class").hasValue())for(s=t.compressSpaces(this.attribute("class").value).split(" "),e=0;e<s.length;e++){if(i=t.Styles["."+s[e]],i!=null)for(r in i)this.styles[r]=i[r];if(i=t.Styles[n.nodeName+"."+s[e]],i!=null)for(r in i)this.styles[r]=i[r]}if(this.attribute("id").hasValue()&&(i=t.Styles["#"+this.attribute("id").value],i!=null))for(r in i)this.styles[r]=i[r];if(this.attribute("style").hasValue())for(i=this.attribute("style").value.split(";"),u=0;u<i.length;u++)if(t.trim(i[u])!=""){var h=i[u].split(":"),r=t.trim(h[0]),l=t.trim(h[1]);this.styles[r]=new t.Property(r,l)}for(this.attribute("id").hasValue()&&t.Definitions[this.attribute("id").value]==null&&(t.Definitions[this.attribute("id").value]=this),u=0;u<n.childNodes.length;u++)f=n.childNodes[u],f.nodeType==1&&this.addChild(f,!0),this.captureTextNodes&&(f.nodeType==3||f.nodeType==4)&&(c=f.nodeValue||f.text||"",t.trim(t.compressSpaces(c))!=""&&this.addChild(new t.Element.tspan(f),!1))}},t.Element.RenderedElementBase=function(n){this.base=t.Element.ElementBase;this.base(n);this.setContext=function(n){var i,u,r,o,f,e,h,s;this.style("fill").isUrlDefinition()?(u=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")),u!=null&&(n.fillStyle=u)):this.style("fill").hasValue()&&(i=this.style("fill"),i.value=="currentColor"&&(i.value=this.style("color").value),i.value!="inherit"&&(n.fillStyle=i.value=="none"?"rgba(0,0,0,0)":i.value));this.style("fill-opacity").hasValue()&&(i=new t.Property("fill",n.fillStyle),i=i.addOpacity(this.style("fill-opacity")),n.fillStyle=i.value);this.style("stroke").isUrlDefinition()?(u=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")),u!=null&&(n.strokeStyle=u)):this.style("stroke").hasValue()&&(r=this.style("stroke"),r.value=="currentColor"&&(r.value=this.style("color").value),r.value!="inherit"&&(n.strokeStyle=r.value=="none"?"rgba(0,0,0,0)":r.value));this.style("stroke-opacity").hasValue()&&(r=new t.Property("stroke",n.strokeStyle),r=r.addOpacity(this.style("stroke-opacity")),n.strokeStyle=r.value);this.style("stroke-width").hasValue()&&(o=this.style("stroke-width").toPixels(),n.lineWidth=o==0?.001:o);this.style("stroke-linecap").hasValue()&&(n.lineCap=this.style("stroke-linecap").value);this.style("stroke-linejoin").hasValue()&&(n.lineJoin=this.style("stroke-linejoin").value);this.style("stroke-miterlimit").hasValue()&&(n.miterLimit=this.style("stroke-miterlimit").value);this.style("stroke-dasharray").hasValue()&&this.style("stroke-dasharray").value!="none"&&(f=t.ToNumberArray(this.style("stroke-dasharray").value),typeof n.setLineDash!="undefined"?n.setLineDash(f):typeof n.webkitLineDash!="undefined"?n.webkitLineDash=f:typeof n.mozDash=="undefined"||f.length==1&&f[0]==0||(n.mozDash=f),e=this.style("stroke-dashoffset").numValueOrDefault(1),typeof n.lineDashOffset!="undefined"?n.lineDashOffset=e:typeof n.webkitLineDashOffset!="undefined"?n.webkitLineDashOffset=e:typeof n.mozDashOffset!="undefined"&&(n.mozDashOffset=e));typeof n.font!="undefined"&&(n.font=t.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString());this.attribute("transform").hasValue()&&(h=new t.Transform(this.attribute("transform").value),h.apply(n));this.style("clip-path",!1,!0).hasValue()&&(s=this.style("clip-path",!1,!0).getDefinition(),s!=null&&s.apply(n));this.style("opacity").hasValue()&&(n.globalAlpha=this.style("opacity").numValue())}},t.Element.RenderedElementBase.prototype=new t.Element.ElementBase,t.Element.PathElementBase=function(n){this.base=t.Element.RenderedElementBase;this.base(n);this.path=function(n){return n!=null&&n.beginPath(),new t.BoundingBox};this.renderChildren=function(n){var i,u,r;if(this.path(n),t.Mouse.checkPath(this,n),n.fillStyle!=""&&(this.style("fill-rule").valueOrDefault("inherit")!="inherit"?n.fill(this.style("fill-rule").value):n.fill()),n.strokeStyle!=""&&n.stroke(),i=this.getMarkers(),i!=null){if(this.style("marker-start").isUrlDefinition()&&(r=this.style("marker-start").getDefinition(),r.render(n,i[0][0],i[0][1])),this.style("marker-mid").isUrlDefinition())for(r=this.style("marker-mid").getDefinition(),u=1;u<i.length-1;u++)r.render(n,i[u][0],i[u][1]);this.style("marker-end").isUrlDefinition()&&(r=this.style("marker-end").getDefinition(),r.render(n,i[i.length-1][0],i[i.length-1][1]))}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}},t.Element.PathElementBase.prototype=new t.Element.RenderedElementBase,t.Element.svg=function(n){this.base=t.Element.RenderedElementBase;this.base(n);this.baseClearContext=this.clearContext;this.clearContext=function(n){this.baseClearContext(n);t.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(n){var i,r,f,e;if(n.strokeStyle="rgba(0,0,0,0)",n.lineCap="butt",n.lineJoin="miter",n.miterLimit=4,typeof n.font!="undefined"&&typeof getComputedStyle!="undefined"&&(n.font=window.getComputedStyle(n.canvas).getPropertyValue("font")),this.baseSetContext(n),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),n.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y")),i=t.ViewPort.width(),r=t.ViewPort.height(),this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),typeof this.root=="undefined"&&(i=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y"),f=0,e=0,this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(f=-this.attribute("refX").toPixels("x"),e=-this.attribute("refY").toPixels("y")),this.attribute("overflow").valueOrDefault("hidden")!="visible"&&(n.beginPath(),n.moveTo(f,e),n.lineTo(i,e),n.lineTo(i,r),n.lineTo(f,r),n.closePath(),n.clip())),t.ViewPort.SetCurrent(i,r),this.attribute("viewBox").hasValue()){var u=t.ToNumberArray(this.attribute("viewBox").value),o=u[0],s=u[1];i=u[2];r=u[3];t.AspectRatio(n,this.attribute("preserveAspectRatio").value,t.ViewPort.width(),i,t.ViewPort.height(),r,o,s,this.attribute("refX").value,this.attribute("refY").value);t.ViewPort.RemoveCurrent();t.ViewPort.SetCurrent(u[2],u[3])}}},t.Element.svg.prototype=new t.Element.RenderedElementBase,t.Element.rect=function(n){this.base=t.Element.PathElementBase;this.base(n);this.path=function(n){var i=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y"),u=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=u),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(u=o),u=Math.min(u,f/2),o=Math.min(o,e/2),n!=null&&(n.beginPath(),n.moveTo(i+u,r),n.lineTo(i+f-u,r),n.quadraticCurveTo(i+f,r,i+f,r+o),n.lineTo(i+f,r+e-o),n.quadraticCurveTo(i+f,r+e,i+f-u,r+e),n.lineTo(i+u,r+e),n.quadraticCurveTo(i,r+e,i,r+e-o),n.lineTo(i,r+o),n.quadraticCurveTo(i,r,i+u,r),n.closePath()),new t.BoundingBox(i,r,i+f,r+e)}},t.Element.rect.prototype=new t.Element.PathElementBase,t.Element.circle=function(n){this.base=t.Element.PathElementBase;this.base(n);this.path=function(n){var r=this.attribute("cx").toPixels("x"),u=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return n!=null&&(n.beginPath(),n.arc(r,u,i,0,Math.PI*2,!0),n.closePath()),new t.BoundingBox(r-i,u-i,r+i,u+i)}},t.Element.circle.prototype=new t.Element.PathElementBase,t.Element.ellipse=function(n){this.base=t.Element.PathElementBase;this.base(n);this.path=function(n){var e=4*((Math.sqrt(2)-1)/3),f=this.attribute("rx").toPixels("x"),u=this.attribute("ry").toPixels("y"),i=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y");return n!=null&&(n.beginPath(),n.moveTo(i,r-u),n.bezierCurveTo(i+e*f,r-u,i+f,r-e*u,i+f,r),n.bezierCurveTo(i+f,r+e*u,i+e*f,r+u,i,r+u),n.bezierCurveTo(i-e*f,r+u,i-f,r+e*u,i-f,r),n.bezierCurveTo(i-f,r-e*u,i-e*f,r-u,i,r-u),n.closePath()),new t.BoundingBox(i-f,r-u,i+f,r+u)}},t.Element.ellipse.prototype=new t.Element.PathElementBase,t.Element.line=function(n){this.base=t.Element.PathElementBase;this.base(n);this.getPoints=function(){return[new t.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new t.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]};this.path=function(n){var i=this.getPoints();return n!=null&&(n.beginPath(),n.moveTo(i[0].x,i[0].y),n.lineTo(i[1].x,i[1].y)),new t.BoundingBox(i[0].x,i[0].y,i[1].x,i[1].y)};this.getMarkers=function(){var n=this.getPoints(),t=n[0].angleTo(n[1]);return[[n[0],t],[n[1],t]]}},t.Element.line.prototype=new t.Element.PathElementBase,t.Element.polyline=function(n){this.base=t.Element.PathElementBase;this.base(n);this.points=t.CreatePath(this.attribute("points").value);this.path=function(n){var r=new t.BoundingBox(this.points[0].x,this.points[0].y),i;for(n!=null&&(n.beginPath(),n.moveTo(this.points[0].x,this.points[0].y)),i=1;i<this.points.length;i++)r.addPoint(this.points[i].x,this.points[i].y),n!=null&&n.lineTo(this.points[i].x,this.points[i].y);return r};this.getMarkers=function(){for(var n=[],t=0;t<this.points.length-1;t++)n.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return n.push([this.points[this.points.length-1],n[n.length-1][1]]),n}},t.Element.polyline.prototype=new t.Element.PathElementBase,t.Element.polygon=function(n){this.base=t.Element.polyline;this.base(n);this.basePath=this.path;this.path=function(n){var t=this.basePath(n);return n!=null&&(n.lineTo(this.points[0].x,this.points[0].y),n.closePath()),t}},t.Element.polygon.prototype=new t.Element.polyline,t.Element.path=function(n){this.base=t.Element.PathElementBase;this.base(n);var i=this.attribute("d").value;i=i.replace(/,/gm," ");i=i.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");i=i.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");i=i.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");i=i.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");i=i.replace(/([0-9])([+\-])/gm,"$1 $2");i=i.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");i=i.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");i=t.compressSpaces(i);i=t.trim(i);this.PathParser=new function(n){this.tokens=n.split(" ");this.reset=function(){this.i=-1;this.command="";this.previousCommand="";this.start=new t.Point(0,0);this.control=new t.Point(0,0);this.current=new t.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){return this.isEnd()?!0:this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null};this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1};this.getToken=function(){return this.i++,this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var n=new t.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(n)};this.getAsControlPoint=function(){var n=this.getPoint();return this.control=n,n};this.getAsCurrentPoint=function(){var n=this.getPoint();return this.current=n,n};this.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"&&this.previousCommand.toLowerCase()!="q"&&this.previousCommand.toLowerCase()!="t")return this.current;return new t.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)};this.makeAbsolute=function(n){return this.isRelativeCommand()&&(n.x+=this.current.x,n.y+=this.current.y),n};this.addMarker=function(n,t,i){i!=null&&this.angles.length>0&&this.angles[this.angles.length-1]==null&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i));this.addMarkerAngle(n,t==null?null:t.angleTo(n))};this.addMarkerAngle=function(n,t){this.points.push(n);this.angles.push(t)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var t,n=0;n<this.angles.length;n++)if(this.angles[n]==null)for(t=n+1;t<this.angles.length;t++)if(this.angles[t]!=null){this.angles[n]=this.angles[t];break}return this.angles}}(i);this.path=function(n){var i=this.PathParser,c,ft,f,y,s,u,r,w;for(i.reset(),c=new t.BoundingBox,n!=null&&n.beginPath();!i.isEnd();){i.nextCommand();switch(i.command){case"M":case"m":for(f=i.getAsCurrentPoint(),i.addMarker(f),c.addPoint(f.x,f.y),n!=null&&n.moveTo(f.x,f.y),i.start=i.current;!i.isCommandOrEnd();)f=i.getAsCurrentPoint(),i.addMarker(f,i.start),c.addPoint(f.x,f.y),n!=null&&n.lineTo(f.x,f.y);break;case"L":case"l":while(!i.isCommandOrEnd())ft=i.current,f=i.getAsCurrentPoint(),i.addMarker(f,ft),c.addPoint(f.x,f.y),n!=null&&n.lineTo(f.x,f.y);break;case"H":case"h":while(!i.isCommandOrEnd())y=new t.Point((i.isRelativeCommand()?i.current.x:0)+i.getScalar(),i.current.y),i.addMarker(y,i.current),i.current=y,c.addPoint(i.current.x,i.current.y),n!=null&&n.lineTo(i.current.x,i.current.y);break;case"V":case"v":while(!i.isCommandOrEnd())y=new t.Point(i.current.x,(i.isRelativeCommand()?i.current.y:0)+i.getScalar()),i.addMarker(y,i.current),i.current=y,c.addPoint(i.current.x,i.current.y),n!=null&&n.lineTo(i.current.x,i.current.y);break;case"C":case"c":while(!i.isCommandOrEnd()){var s=i.current,l=i.getPoint(),u=i.getAsControlPoint(),r=i.getAsCurrentPoint();i.addMarker(r,u,l);c.addBezierCurve(s.x,s.y,l.x,l.y,u.x,u.y,r.x,r.y);n!=null&&n.bezierCurveTo(l.x,l.y,u.x,u.y,r.x,r.y)}break;case"S":case"s":while(!i.isCommandOrEnd()){var s=i.current,l=i.getReflectedControlPoint(),u=i.getAsControlPoint(),r=i.getAsCurrentPoint();i.addMarker(r,u,l);c.addBezierCurve(s.x,s.y,l.x,l.y,u.x,u.y,r.x,r.y);n!=null&&n.bezierCurveTo(l.x,l.y,u.x,u.y,r.x,r.y)}break;case"Q":case"q":while(!i.isCommandOrEnd()){var s=i.current,u=i.getAsControlPoint(),r=i.getAsCurrentPoint();i.addMarker(r,u,u);c.addQuadraticCurve(s.x,s.y,u.x,u.y,r.x,r.y);n!=null&&n.quadraticCurveTo(u.x,u.y,r.x,r.y)}break;case"T":case"t":while(!i.isCommandOrEnd())s=i.current,u=i.getReflectedControlPoint(),i.control=u,r=i.getAsCurrentPoint(),i.addMarker(r,u,u),c.addQuadraticCurve(s.x,s.y,u.x,u.y,r.x,r.y),n!=null&&n.quadraticCurveTo(u.x,u.y,r.x,r.y);break;case"A":case"a":while(!i.isCommandOrEnd()){var s=i.current,e=i.getScalar(),o=i.getScalar(),a=i.getScalar()*(Math.PI/180),ct=i.getScalar(),g=i.getScalar(),r=i.getAsCurrentPoint(),h=new t.Point(Math.cos(a)*(s.x-r.x)/2+Math.sin(a)*(s.y-r.y)/2,-Math.sin(a)*(s.x-r.x)/2+Math.cos(a)*(s.y-r.y)/2),nt=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(o,2);nt>1&&(e*=Math.sqrt(nt),o*=Math.sqrt(nt));w=(ct==g?-1:1)*Math.sqrt((Math.pow(e,2)*Math.pow(o,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(o,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(o,2)*Math.pow(h.x,2)));isNaN(w)&&(w=0);var v=new t.Point(w*e*h.y/o,w*-o*h.x/e),p=new t.Point((s.x+r.x)/2+Math.cos(a)*v.x-Math.sin(a)*v.y,(s.y+r.y)/2+Math.sin(a)*v.x+Math.cos(a)*v.y),et=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2))},b=function(n,t){return(n[0]*t[0]+n[1]*t[1])/(et(n)*et(t))},ot=function(n,t){return(n[0]*t[1]<n[1]*t[0]?-1:1)*Math.acos(b(n,t))},tt=ot([1,0],[(h.x-v.x)/e,(h.y-v.y)/o]),it=[(h.x-v.x)/e,(h.y-v.y)/o],rt=[(-h.x-v.x)/e,(-h.y-v.y)/o],k=ot(it,rt);b(it,rt)<=-1&&(k=Math.PI);b(it,rt)>=1&&(k=0);var ut=1-g?1:-1,d=tt+ut*(k/2),lt=new t.Point(p.x+e*Math.cos(d),p.y+o*Math.sin(d));if(i.addMarkerAngle(lt,d-ut*Math.PI/2),i.addMarkerAngle(r,d-ut*Math.PI),c.addPoint(r.x,r.y),n!=null){var b=e>o?e:o,st=e>o?1:e/o,ht=e>o?o/e:1;n.translate(p.x,p.y);n.rotate(a);n.scale(st,ht);n.arc(0,0,b,tt,tt+k,1-g);n.scale(1/st,1/ht);n.rotate(-a);n.translate(-p.x,-p.y)}}break;case"Z":case"z":n!=null&&n.closePath();i.current=i.start}}return c};this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),r=this.PathParser.getMarkerAngles(),i=[],n=0;n<t.length;n++)i.push([t[n],r[n]]);return i}},t.Element.path.prototype=new t.Element.PathElementBase,t.Element.pattern=function(n){this.base=t.Element.ElementBase;this.base(n);this.createPattern=function(n){var o=this.attribute("width").toPixels("x",!0),s=this.attribute("height").toPixels("y",!0),r=new t.Element.svg,i,u,f,e;for(r.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),r.attributes.width=new t.Property("width",o+"px"),r.attributes.height=new t.Property("height",s+"px"),r.attributes.transform=new t.Property("transform",this.attribute("patternTransform").value),r.children=this.children,i=document.createElement("canvas"),i.width=o,i.height=s,u=i.getContext("2d"),this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&u.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0)),f=-1;f<=1;f++)for(e=-1;e<=1;e++)u.save(),u.translate(f*i.width,e*i.height),r.render(u),u.restore();return n.createPattern(i,"repeat")}},t.Element.pattern.prototype=new t.Element.ElementBase,t.Element.marker=function(n){this.base=t.Element.ElementBase;this.base(n);this.baseRender=this.render;this.render=function(n,i,r){n.translate(i.x,i.y);this.attribute("orient").valueOrDefault("auto")=="auto"&&n.rotate(r);this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&n.scale(n.lineWidth,n.lineWidth);n.save();var u=new t.Element.svg;u.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value);u.attributes.refX=new t.Property("refX",this.attribute("refX").value);u.attributes.refY=new t.Property("refY",this.attribute("refY").value);u.attributes.width=new t.Property("width",this.attribute("markerWidth").value);u.attributes.height=new t.Property("height",this.attribute("markerHeight").value);u.attributes.fill=new t.Property("fill",this.attribute("fill").valueOrDefault("black"));u.attributes.stroke=new t.Property("stroke",this.attribute("stroke").valueOrDefault("none"));u.children=this.children;u.render(n);n.restore();this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&n.scale(1/n.lineWidth,1/n.lineWidth);this.attribute("orient").valueOrDefault("auto")=="auto"&&n.rotate(-r);n.translate(-i.x,-i.y)}},t.Element.marker.prototype=new t.Element.ElementBase,t.Element.defs=function(n){this.base=t.Element.ElementBase;this.base(n);this.render=function(){}},t.Element.defs.prototype=new t.Element.ElementBase,t.Element.GradientBase=function(n){var i,r;for(this.base=t.Element.ElementBase,this.base(n),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[],i=0;i<this.children.length;i++)r=this.children[i],r.type=="stop"&&this.stops.push(r);this.getGradient=function(){};this.createGradient=function(n,i,r){var f=this,v,o,s,h,e,l,u,c,a;if(this.getHrefAttribute().hasValue()&&(f=this.getHrefAttribute().getDefinition()),v=function(n){if(r.hasValue()){var i=new t.Property("color",n);return i.addOpacity(r).value}return n},o=this.getGradient(n,i),o==null)return v(f.stops[f.stops.length-1].color);for(s=0;s<f.stops.length;s++)o.addColorStop(f.stops[s].offset,v(f.stops[s].color));return this.attribute("gradientTransform").hasValue()?(h=t.ViewPort.viewPorts[0],e=new t.Element.rect,e.attributes.x=new t.Property("x",-t.MAX_VIRTUAL_PIXELS/3),e.attributes.y=new t.Property("y",-t.MAX_VIRTUAL_PIXELS/3),e.attributes.width=new t.Property("width",t.MAX_VIRTUAL_PIXELS),e.attributes.height=new t.Property("height",t.MAX_VIRTUAL_PIXELS),l=new t.Element.g,l.attributes.transform=new t.Property("transform",this.attribute("gradientTransform").value),l.children=[e],u=new t.Element.svg,u.attributes.x=new t.Property("x",0),u.attributes.y=new t.Property("y",0),u.attributes.width=new t.Property("width",h.width),u.attributes.height=new t.Property("height",h.height),u.children=[l],c=document.createElement("canvas"),c.width=h.width,c.height=h.height,a=c.getContext("2d"),a.fillStyle=o,u.render(a),a.createPattern(c,"no-repeat")):o}},t.Element.GradientBase.prototype=new t.Element.ElementBase,t.Element.linearGradient=function(n){this.base=t.Element.GradientBase;this.base(n);this.getGradient=function(n,t){var i=this.gradientUnits=="objectBoundingBox"?t.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r=this.gradientUnits=="objectBoundingBox"?i.x()+i.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),u=this.gradientUnits=="objectBoundingBox"?i.y()+i.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),f=this.gradientUnits=="objectBoundingBox"?i.x()+i.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),e=this.gradientUnits=="objectBoundingBox"?i.y()+i.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==f&&u==e?null:n.createLinearGradient(r,u,f,e)}},t.Element.linearGradient.prototype=new t.Element.GradientBase,t.Element.radialGradient=function(n){this.base=t.Element.GradientBase;this.base(n);this.getGradient=function(n,t){var i=t.getBoundingBox(),o;this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%");this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%");this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r=this.gradientUnits=="objectBoundingBox"?i.x()+i.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),u=this.gradientUnits=="objectBoundingBox"?i.y()+i.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),f=r,e=u;return this.attribute("fx").hasValue()&&(f=this.gradientUnits=="objectBoundingBox"?i.x()+i.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(e=this.gradientUnits=="objectBoundingBox"?i.y()+i.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y")),o=this.gradientUnits=="objectBoundingBox"?(i.width()+i.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels(),n.createRadialGradient(f,e,0,r,u,o)}},t.Element.radialGradient.prototype=new t.Element.GradientBase,t.Element.stop=function(n){this.base=t.Element.ElementBase;this.base(n);this.offset=this.attribute("offset").numValue();this.offset<0&&(this.offset=0);this.offset>1&&(this.offset=1);var i=this.style("stop-color");this.style("stop-opacity").hasValue()&&(i=i.addOpacity(this.style("stop-opacity")));this.color=i.value},t.Element.stop.prototype=new t.Element.ElementBase,t.Element.AnimateBase=function(n){this.base=t.Element.ElementBase;this.base(n);t.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").toMilliseconds();this.getProperty=function(){var t=this.attribute("attributeType").value,n=this.attribute("attributeName").value;return t=="CSS"?this.parent.style(n,!0):this.parent.attribute(n,!0)};this.initialValue=null;this.initialUnits="";this.removed=!1;this.calcValue=function(){return""};this.update=function(n){var i,t,r;if(this.initialValue==null&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if(this.attribute("repeatCount").value=="indefinite"||this.attribute("repeatDur").value=="indefinite")this.duration=0;else if(this.attribute("fill").valueOrDefault("remove")!="freeze"||this.frozen){if(this.attribute("fill").valueOrDefault("remove")=="remove"&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}return this.duration=this.duration+n,i=!1,this.begin<this.duration&&(t=this.calcValue(),this.attribute("type").hasValue()&&(r=this.attribute("type").value,t=r+"("+t+")"),this.getProperty().value=t,i=!0),i};this.from=this.attribute("from");this.to=this.attribute("to");this.values=this.attribute("values");this.values.hasValue()&&(this.values.value=this.values.value.split(";"));this.progress=function(){var n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var i=n.progress*(this.values.value.length-1),r=Math.floor(i),u=Math.ceil(i);n.from=new t.Property("from",parseFloat(this.values.value[r]));n.to=new t.Property("to",parseFloat(this.values.value[u]));n.progress=(i-r)/(u-r)}else n.from=this.from,n.to=this.to;return n}},t.Element.AnimateBase.prototype=new t.Element.ElementBase,t.Element.animate=function(n){this.base=t.Element.AnimateBase;this.base(n);this.calcValue=function(){var n=this.progress(),t=n.from.numValue()+(n.to.numValue()-n.from.numValue())*n.progress;return t+this.initialUnits}},t.Element.animate.prototype=new t.Element.AnimateBase,t.Element.animateColor=function(n){this.base=t.Element.AnimateBase;this.base(n);this.calcValue=function(){var t=this.progress(),n=new RGBColor(t.from.value),i=new RGBColor(t.to.value);if(n.ok&&i.ok){var r=n.r+(i.r-n.r)*t.progress,u=n.g+(i.g-n.g)*t.progress,f=n.b+(i.b-n.b)*t.progress;return"rgb("+parseInt(r,10)+","+parseInt(u,10)+","+parseInt(f,10)+")"}return this.attribute("from").value}},t.Element.animateColor.prototype=new t.Element.AnimateBase,t.Element.animateTransform=function(n){this.base=t.Element.AnimateBase;this.base(n);this.calcValue=function(){for(var i=this.progress(),r=t.ToNumberArray(i.from.value),f=t.ToNumberArray(i.to.value),u="",n=0;n<r.length;n++)u+=r[n]+(f[n]-r[n])*i.progress+" ";return u}},t.Element.animateTransform.prototype=new t.Element.animate,t.Element.font=function(n){var r,i;for(this.base=t.Element.ElementBase,this.base(n),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[],r=0;r<this.children.length;r++)i=this.children[r],i.type=="font-face"?(this.fontFace=i,i.style("font-family").hasValue()&&(t.Definitions[i.style("font-family").value]=this)):i.type=="missing-glyph"?this.missingGlyph=i:i.type=="glyph"&&(i.arabicForm!=""?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[i.unicode]=="undefined"&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)},t.Element.font.prototype=new t.Element.ElementBase,t.Element.fontface=function(n){this.base=t.Element.ElementBase;this.base(n);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()},t.Element.fontface.prototype=new t.Element.ElementBase,t.Element.missingglyph=function(n){this.base=t.Element.path;this.base(n);this.horizAdvX=0},t.Element.missingglyph.prototype=new t.Element.path,t.Element.glyph=function(n){this.base=t.Element.path;this.base(n);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value},t.Element.glyph.prototype=new t.Element.path,t.Element.text=function(n){this.captureTextNodes=!0;this.base=t.Element.RenderedElementBase;this.base(n);this.baseSetContext=this.setContext;this.setContext=function(n){this.baseSetContext(n);var t=this.style("dominant-baseline").toTextBaseline();t==null&&(t=this.style("alignment-baseline").toTextBaseline());t!=null&&(n.textBaseline=t)};this.getBoundingBox=function(){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),r=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize);return new t.BoundingBox(n,i-r,n+Math.floor(r*2/3)*this.children[0].getText().length,i)};this.renderChildren=function(n){this.x=this.attribute("x").toPixels("x");this.y=this.attribute("y").toPixels("y");this.x+=this.getAnchorDelta(n,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(n,this,t)};this.getAnchorDelta=function(n,t,i){var e=this.style("text-anchor").valueOrDefault("start"),u,r,f;if(e!="start"){for(u=0,r=i;r<t.children.length;r++){if(f=t.children[r],r>i&&f.attribute("x").hasValue())break;u+=f.measureTextRecursive(n)}return-1*(e=="end"?u:u/2)}return 0};this.renderChild=function(n,t,i){var r=t.children[i],i;for(r.attribute("x").hasValue()?(r.x=r.attribute("x").toPixels("x")+this.getAnchorDelta(n,t,i),r.attribute("dx").hasValue()&&(r.x+=r.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),r.attribute("dx").hasValue()&&(this.x+=r.attribute("dx").toPixels("x")),r.x=this.x),this.x=r.x+r.measureText(n),r.attribute("y").hasValue()?(r.y=r.attribute("y").toPixels("y"),r.attribute("dy").hasValue()&&(r.y+=r.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),r.attribute("dy").hasValue()&&(this.y+=r.attribute("dy").toPixels("y")),r.y=this.y),this.y=r.y,r.render(n),i=0;i<r.children.length;i++)this.renderChild(n,r,i)}},t.Element.text.prototype=new t.Element.RenderedElementBase,t.Element.TextElementBase=function(n){this.base=t.Element.RenderedElementBase;this.base(n);this.getGlyph=function(n,t,i){var u=t[i],r=null,f;return n.isArabic?(f="isolated",(i==0||t[i-1]==" ")&&i<t.length-2&&t[i+1]!=" "&&(f="terminal"),i>0&&t[i-1]!=" "&&i<t.length-2&&t[i+1]!=" "&&(f="medial"),i>0&&t[i-1]!=" "&&(i==t.length-1||t[i+1]==" ")&&(f="initial"),typeof n.glyphs[u]!="undefined"&&(r=n.glyphs[u][f],r==null&&n.glyphs[u].type=="glyph"&&(r=n.glyphs[u]))):r=n.glyphs[u],r==null&&(r=n.missingGlyph),r};this.renderChildren=function(n){var i=this.parent.style("font-family").getDefinition(),e,r,s,u,c;if(i!=null){var o=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),h=this.parent.style("font-style").valueOrDefault(t.Font.Parse(t.ctx.font).fontStyle),f=this.getText();for(i.isRTL&&(f=f.split("").reverse().join("")),e=t.ToNumberArray(this.parent.attribute("dx").value),r=0;r<f.length;r++)s=this.getGlyph(i,f,r),u=o/i.fontFace.unitsPerEm,n.translate(this.x,this.y),n.scale(u,-u),c=n.lineWidth,n.lineWidth=n.lineWidth*i.fontFace.unitsPerEm/o,h=="italic"&&n.transform(1,0,.4,1,0,0),s.render(n),h=="italic"&&n.transform(1,0,-.4,1,0,0),n.lineWidth=c,n.scale(1/u,-1/u),n.translate(-this.x,-this.y),this.x+=o*(s.horizAdvX||i.horizAdvX)/i.fontFace.unitsPerEm,typeof e[r]=="undefined"||isNaN(e[r])||(this.x+=e[r]);return}n.fillStyle!=""&&n.fillText(t.compressSpaces(this.getText()),this.x,this.y);n.strokeStyle!=""&&n.strokeText(t.compressSpaces(this.getText()),this.x,this.y)};this.getText=function(){};this.measureTextRecursive=function(n){for(var i=this.measureText(n),t=0;t<this.children.length;t++)i+=this.children[t].measureTextRecursive(n);return i};this.measureText=function(n){var r=this.parent.style("font-family").getDefinition(),f,i,s,o,h;if(r!=null){var c=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),e=0,u=this.getText();for(r.isRTL&&(u=u.split("").reverse().join("")),f=t.ToNumberArray(this.parent.attribute("dx").value),i=0;i<u.length;i++)s=this.getGlyph(r,u,i),e+=(s.horizAdvX||r.horizAdvX)*c/r.fontFace.unitsPerEm,typeof f[i]=="undefined"||isNaN(f[i])||(e+=f[i]);return e}return(o=t.compressSpaces(this.getText()),!n.measureText)?o.length*10:(n.save(),this.setContext(n),h=n.measureText(o).width,n.restore(),h)}},t.Element.TextElementBase.prototype=new t.Element.RenderedElementBase,t.Element.tspan=function(n){this.captureTextNodes=!0;this.base=t.Element.TextElementBase;this.base(n);this.text=n.nodeValue||n.text||"";this.getText=function(){return this.text}},t.Element.tspan.prototype=new t.Element.TextElementBase,t.Element.tref=function(n){this.base=t.Element.TextElementBase;this.base(n);this.getText=function(){var n=this.getHrefAttribute().getDefinition();if(n!=null)return n.children[0].getText()}},t.Element.tref.prototype=new t.Element.TextElementBase,t.Element.a=function(n){this.base=t.Element.TextElementBase;this.base(n);this.hasText=n.childNodes.length>0;for(var i=0;i<n.childNodes.length;i++)n.childNodes[i].nodeType!=3&&(this.hasText=!1);this.text=this.hasText?n.childNodes[0].nodeValue:"";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(n){var r,i;this.hasText?(this.baseRenderChildren(n),r=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize),t.Mouse.checkBoundingBox(this,new t.BoundingBox(this.x,this.y-r.toPixels("y"),this.x+this.measureText(n),this.y))):this.children.length>0&&(i=new t.Element.g,i.children=this.children,i.parent=this,i.render(n))};this.onclick=function(){window.open(this.getHrefAttribute().value)};this.onmousemove=function(){t.ctx.canvas.style.cursor="pointer"}},t.Element.a.prototype=new t.Element.TextElementBase,t.Element.image=function(n){var i,r,u;(this.base=t.Element.RenderedElementBase,this.base(n),i=this.getHrefAttribute().value,i!="")&&(r=i.match(/\.svg$/),t.Images.push(this),this.loaded=!1,r?(this.img=t.ajax(i),this.loaded=!0):(this.img=document.createElement("img"),t.opts.useCORS==!0&&(this.img.crossOrigin="Anonymous"),u=this,this.img.onload=function(){u.loaded=!0},this.img.onerror=function(){t.log('ERROR: image "'+i+'" not found');u.loaded=!0},this.img.src=i),this.renderChildren=function(n){var f=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),u=this.attribute("height").toPixels("y");i!=0&&u!=0&&(n.save(),r?n.drawSvg(this.img,f,e,i,u):(n.translate(f,e),t.AspectRatio(n,this.attribute("preserveAspectRatio").value,i,this.img.width,u,this.img.height,0,0),n.drawImage(this.img,0,0)),n.restore())},this.getBoundingBox=function(){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),u=this.attribute("height").toPixels("y");return new t.BoundingBox(n,i,n+r,i+u)})},t.Element.image.prototype=new t.Element.RenderedElementBase,t.Element.g=function(n){this.base=t.Element.RenderedElementBase;this.base(n);this.getBoundingBox=function(){for(var i=new t.BoundingBox,n=0;n<this.children.length;n++)i.addBoundingBox(this.children[n].getBoundingBox());return i}},t.Element.g.prototype=new t.Element.RenderedElementBase,t.Element.symbol=function(n){this.base=t.Element.RenderedElementBase;this.base(n);this.render=function(){}},t.Element.symbol.prototype=new t.Element.RenderedElementBase,t.Element.style=function(n){var r,h,i,c,l,s,u,d,e,f,a,nt;for(this.base=t.Element.ElementBase,this.base(n),r="",i=0;i<n.childNodes.length;i++)r+=n.childNodes[i].nodeValue;for(r=r.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),r=t.compressSpaces(r),h=r.split("}"),i=0;i<h.length;i++)if(t.trim(h[i])!=""){var w=h[i].split("{"),b=w[0].split(","),o=w[1].split(";");for(c=0;c<b.length;c++)if(l=t.trim(b[c]),l!=""){for(s={},u=0;u<o.length;u++){var v=o[u].indexOf(":"),y=o[u].substr(0,v),k=o[u].substr(v+1,o[u].length-v);y!=null&&k!=null&&(s[t.trim(y)]=new t.Property(t.trim(y),t.trim(k)))}if(t.Styles[l]=s,l=="@font-face")for(d=s["font-family"].value.replace(/"/g,""),e=s.src.value.split(","),f=0;f<e.length;f++)if(e[f].indexOf('format("svg")')>0){var p=e[f].indexOf("url"),tt=e[f].indexOf(")",p),it=e[f].substr(p+5,tt-p-6),rt=t.parseXml(t.ajax(it)),g=rt.getElementsByTagName("font");for(a=0;a<g.length;a++)nt=t.CreateElement(g[a]),t.Definitions[d]=nt}}}},t.Element.style.prototype=new t.Element.ElementBase,t.Element.use=function(n){this.base=t.Element.RenderedElementBase;this.base(n);this.baseSetContext=this.setContext;this.setContext=function(n){this.baseSetContext(n);this.attribute("x").hasValue()&&n.translate(this.attribute("x").toPixels("x"),0);this.attribute("y").hasValue()&&n.translate(0,this.attribute("y").toPixels("y"))};var i=this.getHrefAttribute().getDefinition();this.path=function(n){i!=null&&i.path(n)};this.getBoundingBox=function(){if(i!=null)return i.getBoundingBox()};this.renderChildren=function(n){var r,u;i!=null&&(r=i,i.type=="symbol"&&(r=new t.Element.svg,r.type="svg",r.attributes.viewBox=new t.Property("viewBox",i.attribute("viewBox").value),r.attributes.preserveAspectRatio=new t.Property("preserveAspectRatio",i.attribute("preserveAspectRatio").value),r.attributes.overflow=new t.Property("overflow",i.attribute("overflow").value),r.children=i.children),r.type=="svg"&&(this.attribute("width").hasValue()&&(r.attributes.width=new t.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(r.attributes.height=new t.Property("height",this.attribute("height").value))),u=r.parent,r.parent=null,r.render(n),r.parent=u)}},t.Element.use.prototype=new t.Element.RenderedElementBase,t.Element.mask=function(n){this.base=t.Element.ElementBase;this.base(n);this.apply=function(n,i){var h=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y"),r,l,v,o,a,s,u;if(f==0&&e==0){for(r=new t.BoundingBox,l=0;l<this.children.length;l++)r.addBoundingBox(this.children[l].getBoundingBox());var h=Math.floor(r.x1),c=Math.floor(r.y1),f=Math.floor(r.width()),e=Math.floor(r.height())}v=i.attribute("mask").value;i.attribute("mask").value="";o=document.createElement("canvas");o.width=h+f;o.height=c+e;a=o.getContext("2d");this.renderChildren(a);s=document.createElement("canvas");s.width=h+f;s.height=c+e;u=s.getContext("2d");i.render(u);u.globalCompositeOperation="destination-in";u.fillStyle=a.createPattern(o,"no-repeat");u.fillRect(0,0,h+f,c+e);n.fillStyle=u.createPattern(s,"no-repeat");n.fillRect(0,0,h+f,c+e);i.attribute("mask").value=v};this.render=function(){}},t.Element.mask.prototype=new t.Element.ElementBase,t.Element.clipPath=function(n){this.base=t.Element.ElementBase;this.base(n);this.apply=function(n){var e=CanvasRenderingContext2D.prototype.beginPath,u,f,i,r;for(CanvasRenderingContext2D.prototype.beginPath=function(){},u=CanvasRenderingContext2D.prototype.closePath,CanvasRenderingContext2D.prototype.closePath=function(){},e.call(n),f=0;f<this.children.length;f++)i=this.children[f],typeof i.path!="undefined"&&(r=null,i.attribute("transform").hasValue()&&(r=new t.Transform(i.attribute("transform").value),r.apply(n)),i.path(n),CanvasRenderingContext2D.prototype.closePath=u,r&&r.unapply(n));u.call(n);n.clip();CanvasRenderingContext2D.prototype.beginPath=e;CanvasRenderingContext2D.prototype.closePath=u};this.render=function(){}},t.Element.clipPath.prototype=new t.Element.ElementBase,t.Element.filter=function(n){this.base=t.Element.ElementBase;this.base(n);this.apply=function(n,t){var e=t.getBoundingBox(),l=Math.floor(e.x1),a=Math.floor(e.y1),o=Math.floor(e.width()),s=Math.floor(e.height()),v=t.style("filter").value,i,r,c,f,h,u;for(t.style("filter").value="",i=0,r=0,u=0;u<this.children.length;u++)c=this.children[u].extraFilterDistance||0,i=Math.max(i,c),r=Math.max(r,c);for(f=document.createElement("canvas"),f.width=o+2*i,f.height=s+2*r,h=f.getContext("2d"),h.translate(-l+i,-a+r),t.render(h),u=0;u<this.children.length;u++)this.children[u].apply(h,0,0,o+2*i,s+2*r);n.drawImage(f,0,0,o+2*i,s+2*r,l-i,a-r,o+2*i,s+2*r);t.style("filter",!0).value=v};this.render=function(){}},t.Element.filter.prototype=new t.Element.ElementBase,t.Element.feMorphology=function(n){this.base=t.Element.ElementBase;this.base(n);this.apply=function(){}},t.Element.feMorphology.prototype=new t.Element.ElementBase,t.Element.feComposite=function(n){this.base=t.Element.ElementBase;this.base(n);this.apply=function(){}},t.Element.feComposite.prototype=new t.Element.ElementBase,t.Element.feColorMatrix=function(n){function e(n,t,i,r,u,f){return n[i*r*4+t*4+f]}function o(n,t,i,r,u,f,e){n[i*r*4+t*4+f]=e}function i(n,t){var i=f[n];return i*(i<0?t-255:t)}var f,r,s,u;this.base=t.Element.ElementBase;this.base(n);f=t.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":r=f[0];f=[.213+.787*r,.715-.715*r,.072-.072*r,0,0,.213-.213*r,.715+.285*r,.072-.072*r,0,0,.213-.213*r,.715-.715*r,.072+.928*r,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":s=f[0]*Math.PI/180;u=function(n,t,i){return n+Math.cos(s)*t+Math.sin(s)*i};f=[u(.213,.787,-.213),u(.715,-.715,-.715),u(.072,-.072,.928),0,0,u(.213,-.213,.143),u(.715,.285,.14),u(.072,-.072,-.283),0,0,u(.213,-.213,-.787),u(.715,-.715,.715),u(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(n,t,r,u,f){for(var t,s=n.getImageData(0,0,u,f),r=0;r<f;r++)for(t=0;t<u;t++){var h=e(s.data,t,r,u,f,0),c=e(s.data,t,r,u,f,1),l=e(s.data,t,r,u,f,2),a=e(s.data,t,r,u,f,3);o(s.data,t,r,u,f,0,i(0,h)+i(1,c)+i(2,l)+i(3,a)+i(4,1));o(s.data,t,r,u,f,1,i(5,h)+i(6,c)+i(7,l)+i(8,a)+i(9,1));o(s.data,t,r,u,f,2,i(10,h)+i(11,c)+i(12,l)+i(13,a)+i(14,1));o(s.data,t,r,u,f,3,i(15,h)+i(16,c)+i(17,l)+i(18,a)+i(19,1))}n.clearRect(0,0,u,f);n.putImageData(s,0,0)}},t.Element.feColorMatrix.prototype=new t.Element.ElementBase,t.Element.feGaussianBlur=function(n){this.base=t.Element.ElementBase;this.base(n);this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue());this.extraFilterDistance=this.blurRadius;this.apply=function(n,i,r,u,f){if(typeof stackBlurCanvasRGBA=="undefined"){t.log("ERROR: StackBlur.js must be included for blur to work");return}n.canvas.id=t.UniqueId();n.canvas.style.display="none";document.body.appendChild(n.canvas);stackBlurCanvasRGBA(n.canvas.id,i,r,u,f,this.blurRadius);document.body.removeChild(n.canvas)}},t.Element.feGaussianBlur.prototype=new t.Element.ElementBase,t.Element.title=function(){},t.Element.title.prototype=new t.Element.ElementBase,t.Element.desc=function(){},t.Element.desc.prototype=new t.Element.ElementBase,t.Element.MISSING=function(n){t.log("ERROR: Element '"+n.nodeName+"' not yet implemented.")},t.Element.MISSING.prototype=new t.Element.ElementBase,t.CreateElement=function(n){var i=n.nodeName.replace(/^[^:]+:/,""),r;return i=i.replace(/\-/g,""),r=null,r=typeof t.Element[i]!="undefined"?new t.Element[i](n):new t.Element.MISSING(n),r.type=n.nodeName,r},t.load=function(n,i){t.loadXml(n,t.ajax(i))},t.loadXml=function(n,i){t.loadXmlDoc(n,t.parseXml(i))},t.loadXmlDoc=function(n,i){var u,r;t.init(n);u=function(t){for(var i=n.canvas;i;)t.x-=i.offsetLeft,t.y-=i.offsetTop,i=i.offsetParent;return window.scrollX&&(t.x+=window.scrollX),window.scrollY&&(t.y+=window.scrollY),t};t.opts.ignoreMouse!=!0&&(n.canvas.onclick=function(n){var i=u(new t.Point(n!=null?n.clientX:event.clientX,n!=null?n.clientY:event.clientY));t.Mouse.onclick(i.x,i.y)},n.canvas.onmousemove=function(n){var i=u(new t.Point(n!=null?n.clientX:event.clientX,n!=null?n.clientY:event.clientY));t.Mouse.onmousemove(i.x,i.y)});r=t.CreateElement(i.documentElement);r.root=!0;var e=!0,o=function(){var o,s;if(t.ViewPort.Clear(),n.canvas.parentNode&&t.ViewPort.SetCurrent(n.canvas.parentNode.clientWidth,n.canvas.parentNode.clientHeight),t.opts.ignoreDimensions!=!0&&(r.style("width").hasValue()&&(n.canvas.width=r.style("width").toPixels("x"),n.canvas.style.width=n.canvas.width+"px"),r.style("height").hasValue()&&(n.canvas.height=r.style("height").toPixels("y"),n.canvas.style.height=n.canvas.height+"px")),o=n.canvas.clientWidth||n.canvas.width,s=n.canvas.clientHeight||n.canvas.height,t.opts.ignoreDimensions==!0&&r.style("width").hasValue()&&r.style("height").hasValue()&&(o=r.style("width").toPixels("x"),s=r.style("height").toPixels("y")),t.ViewPort.SetCurrent(o,s),t.opts.offsetX!=null&&(r.attribute("x",!0).value=t.opts.offsetX),t.opts.offsetY!=null&&(r.attribute("y",!0).value=t.opts.offsetY),t.opts.scaleWidth!=null||t.opts.scaleHeight!=null){var u=null,f=null,h=t.ToNumberArray(r.attribute("viewBox").value);t.opts.scaleWidth!=null&&(r.attribute("width").hasValue()?u=r.attribute("width").toPixels("x")/t.opts.scaleWidth:isNaN(h[2])||(u=h[2]/t.opts.scaleWidth));t.opts.scaleHeight!=null&&(r.attribute("height").hasValue()?f=r.attribute("height").toPixels("y")/t.opts.scaleHeight:isNaN(h[3])||(f=h[3]/t.opts.scaleHeight));u==null&&(u=f);f==null&&(f=u);r.attribute("width",!0).value=t.opts.scaleWidth;r.attribute("height",!0).value=t.opts.scaleHeight;r.attribute("transform",!0).value+=" scale("+1/u+","+1/f+")"}t.opts.ignoreClear!=!0&&n.clearRect(0,0,o,s);r.render(n);e&&(e=!1,typeof t.opts.renderCallback=="function"&&t.opts.renderCallback(i))},f=!0;t.ImagesLoaded()&&(f=!1,o());t.intervalID=setInterval(function(){var n=!1,i;if(f&&t.ImagesLoaded()&&(f=!1,n=!0),t.opts.ignoreMouse!=!0&&(n=n|t.Mouse.hasEvents()),t.opts.ignoreAnimation!=!0)for(i=0;i<t.Animations.length;i++)n=n|t.Animations[i].update(1e3/t.FRAMERATE);typeof t.opts.forceRedraw=="function"&&t.opts.forceRedraw()==!0&&(n=!0);n&&(o(),t.Mouse.runEvents())},1e3/t.FRAMERATE)},t.stop=function(){t.intervalID&&clearInterval(t.intervalID)},t.Mouse=new function(){this.events=[];this.hasEvents=function(){return this.events.length!=0};this.onclick=function(n,t){this.events.push({type:"onclick",x:n,y:t,run:function(n){n.onclick&&n.onclick()}})};this.onmousemove=function(n,t){this.events.push({type:"onmousemove",x:n,y:t,run:function(n){n.onmousemove&&n.onmousemove()}})};this.eventElements=[];this.checkPath=function(n,t){for(var r,i=0;i<this.events.length;i++)r=this.events[i],t.isPointInPath&&t.isPointInPath(r.x,r.y)&&(this.eventElements[i]=n)};this.checkBoundingBox=function(n,t){for(var r,i=0;i<this.events.length;i++)r=this.events[i],t.isPointInBox(r.x,r.y)&&(this.eventElements[i]=n)};this.runEvents=function(){var n,r,i;for(t.ctx.canvas.style.cursor="",n=0;n<this.events.length;n++)for(r=this.events[n],i=this.eventElements[n];i;)r.run(i),i=i.parent;this.events=[];this.eventElements=[]}},t}this.canvg=function(t,i,r){var h,o,u,f,c,e,s;if(t==null&&i==null&&r==null){for(h=document.querySelectorAll("svg"),o=0;o<h.length;o++)u=h[o],f=document.createElement("canvas"),f.width=u.clientWidth,f.height=u.clientHeight,u.parentNode.insertBefore(f,u),u.parentNode.removeChild(u),c=document.createElement("div"),c.appendChild(u),canvg(f,c.innerHTML);return}typeof t=="string"&&(t=document.getElementById(t));t.svg!=null&&t.svg.stop();e=n(r||{});t.childNodes.length==1&&t.childNodes[0].nodeName=="OBJECT"||(t.svg=e);s=t.getContext("2d");typeof i.documentElement!="undefined"?e.loadXmlDoc(s,i):i.substr(0,1)=="<"?e.loadXml(s,i):e.load(s,i)}})();typeof CanvasRenderingContext2D!="undefined"&&(CanvasRenderingContext2D.prototype.drawSvg=function(n,t,i,r,u){canvg(this.canvas,n,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:i,scaleWidth:r,scaleHeight:u})})